<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ouroboros.Consensus.Ledger.History</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Consensus.Ledger.History.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ouroboros-consensus-0.1.0.0: Consensus layer for the Ouroboros blockchain protocol</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.Ledger.History</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Template to track the <em>history</em> of something in the ledger state.</p><p>For example, for Byron, this can be used to track the <em>delegation history</em>.</p><p>Intended for qualified import</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:History">History</a> st = <a href="#v:History">History</a> {<ul class="subs"><li><a href="#v:historyAnchor">historyAnchor</a> &#8759; !(<a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a>)</li><li><a href="#v:historySnapshots">historySnapshots</a> &#8759; !(<a href="Ouroboros-Consensus-Ledger-History.html#t:Snapshots" title="Ouroboros.Consensus.Ledger.History">Snapshots</a> st)</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:Snapshots">Snapshots</a> st = <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Data-Sequence-Strict.html#t:StrictSeq" title="Data.Sequence.Strict">StrictSeq</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:Snapshot" title="Ouroboros.Consensus.Ledger.History">Snapshot</a> st)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Snapshot">Snapshot</a> st = <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-SlotBounded.html#t:SlotBounded" title="Cardano.Slotting.SlotBounded">SlotBounded</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-SlotBounded.html#v:IX" title="Cardano.Slotting.SlotBounded">IX</a> st</li><li class="src short"><a href="#v:empty">empty</a> &#8759; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st</li><li class="src short"><a href="#v:snapOld">snapOld</a> &#8759; &#8704; st. <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a> &#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; st &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st</li><li class="src short"><a href="#v:find">find</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> st</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:History" class="def">History</a> st <a href="src/Ouroboros.Consensus.Ledger.History.html#History" class="link">Source</a> <a href="#t:History" class="selflink">#</a></p><div class="doc"><p>History</p><p>In some ledgers, it is required to store some historical snapshots of some
 piece of data to support the implementation of
 <code>ledgerViewForecastAt</code>. This data type is a template to track
 some form of <em>state</em> that requires historical snapshots in the ledger
 state. If the description below fits the bill, you can use the <code><a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a></code>
 type to track your <em>state</em>:</p><p>Each time that the state is updated (that is, when applying a block that
 changes it), we take a snapshot of the <em>old</em> state (the state as it was
 before the block was applied).</p><p>We store the state along with its slot bounds:</p><ul><li>The slot number of the block that changed the state serves as an
   <em>exclusive</em> upper bound.</li><li>The (exclusive) upper bound of the <em>previous</em> historical state serves as
   an <em>inclusive</em> lower bound (since this is the slot at which this state
   became active).</li></ul><p>We never need to go back in history for more than <code>2k</code> slots, allowing us
 to drop states from history as time passes, keeping the history bounded in
 size. The history will be empty if</p><ul><li>The state never changed, or</li><li>We cannot roll back far enough to require a historical state.</li></ul><p>Since the (inclusive) lower bound of the next snapshot will be set to be
 equal to the (exclusive) upper bound of the previous, we must remember this
 previous bound even when the ledger is empty. Near genesis we will set this
 at <code>Origin</code>, which will indeed by the lower bound for the first snapshot.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:History" class="def">History</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:historyAnchor" class="def">historyAnchor</a> &#8759; !(<a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:historySnapshots" class="def">historySnapshots</a> &#8759; !(<a href="Ouroboros-Consensus-Ledger-History.html#t:Snapshots" title="Ouroboros.Consensus.Ledger.History">Snapshots</a> st)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:History" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:History:Eq:1"></span> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> st &#8658; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st)</span> <a href="src/Ouroboros.Consensus.Ledger.History.html#line-77" class="link">Source</a> <a href="#t:History" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:History:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Ledger-History.html">Ouroboros.Consensus.Ledger.History</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> &#8759; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> &#8759; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:History:Show:2"></span> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> st &#8658; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st)</span> <a href="src/Ouroboros.Consensus.Ledger.History.html#line-77" class="link">Source</a> <a href="#t:History" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:History:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Ledger-History.html">Ouroboros.Consensus.Ledger.History</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> &#8759; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> &#8759; [<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st] &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:History:Generic:3"></span> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st)</span> <a href="src/Ouroboros.Consensus.Ledger.History.html#line-77" class="link">Source</a> <a href="#t:History" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:History:Generic:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Ledger-History.html">Ouroboros.Consensus.Ledger.History</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st) &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> &#8759; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st) x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st) x &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:History:NoUnexpectedThunks:4"></span> <a href="Ouroboros-Consensus-Util-IOLike.html#t:NoUnexpectedThunks" title="Ouroboros.Consensus.Util.IOLike">NoUnexpectedThunks</a> st &#8658; <a href="Ouroboros-Consensus-Util-IOLike.html#t:NoUnexpectedThunks" title="Ouroboros.Consensus.Util.IOLike">NoUnexpectedThunks</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st)</span> <a href="src/Ouroboros.Consensus.Ledger.History.html#line-78" class="link">Source</a> <a href="#t:History" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:History:NoUnexpectedThunks:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Ledger-History.html">Ouroboros.Consensus.Ledger.History</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:noUnexpectedThunks">noUnexpectedThunks</a> &#8759; [<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a>] &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-GHC-Heap-NormalForm-Classy.html#t:ThunkInfo" title="Cardano.Prelude.GHC.Heap.NormalForm.Classy">ThunkInfo</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src" class="link">Source</a> <a href="#v:noUnexpectedThunks" class="selflink">#</a></p><p class="src"><a href="#v:whnfNoUnexpectedThunks">whnfNoUnexpectedThunks</a> &#8759; [<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a>] &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-GHC-Heap-NormalForm-Classy.html#t:ThunkInfo" title="Cardano.Prelude.GHC.Heap.NormalForm.Classy">ThunkInfo</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src" class="link">Source</a> <a href="#v:whnfNoUnexpectedThunks" class="selflink">#</a></p><p class="src"><a href="#v:showTypeOf">showTypeOf</a> &#8759; <a href="Data-SOP-Strict.html#t:Proxy" title="Data.SOP.Strict">Proxy</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st) &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src" class="link">Source</a> <a href="#v:showTypeOf" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:History:Rep:5"></span> <span class="keyword">type</span> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st)</span> <a href="src/Ouroboros.Consensus.Ledger.History.html#line-77" class="link">Source</a> <a href="#t:History" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:History:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Ledger-History.html">Ouroboros.Consensus.Ledger.History</a></p> <div class="src"><span class="keyword">type</span> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st) = <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;History&quot; &quot;Ouroboros.Consensus.Ledger.History&quot; &quot;ouroboros-consensus-0.1.0.0-inplace&quot; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#v:False" title="Data.Bool">False</a>) (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;History&quot; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#v:True" title="Data.Bool">True</a>) (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#v:Just" title="GHC.Maybe">Just</a> &quot;historyAnchor&quot;) <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:SourceStrict" title="GHC.Generics">SourceStrict</a> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:DecidedStrict" title="GHC.Generics">DecidedStrict</a>) (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a>)) <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#v:Just" title="GHC.Maybe">Just</a> &quot;historySnapshots&quot;) <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:SourceStrict" title="GHC.Generics">SourceStrict</a> <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#v:DecidedStrict" title="GHC.Generics">DecidedStrict</a>) (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:Snapshots" title="Ouroboros.Consensus.Ledger.History">Snapshots</a> st))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Snapshots" class="def">Snapshots</a> st = <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Data-Sequence-Strict.html#t:StrictSeq" title="Data.Sequence.Strict">StrictSeq</a> (<a href="Ouroboros-Consensus-Ledger-History.html#t:Snapshot" title="Ouroboros.Consensus.Ledger.History">Snapshot</a> st) <a href="src/Ouroboros.Consensus.Ledger.History.html#Snapshots" class="link">Source</a> <a href="#t:Snapshots" class="selflink">#</a></p><div class="doc"><p>Snapshots strictly after genesis</p><p>More recent snapshots are stored at the end of the sequence.</p><p>Invariant: the (exclusive) upper bound of each snapshot must equal the
 (inclusive) lower bound of the next.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Snapshot" class="def">Snapshot</a> st = <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-SlotBounded.html#t:SlotBounded" title="Cardano.Slotting.SlotBounded">SlotBounded</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-SlotBounded.html#v:IX" title="Cardano.Slotting.SlotBounded">IX</a> st <a href="src/Ouroboros.Consensus.Ledger.History.html#Snapshot" class="link">Source</a> <a href="#t:Snapshot" class="selflink">#</a></p><div class="doc"><p>Historical snapshot of <code>s</code></p><p>See <code><a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a></code> for details</p></div></div><div class="top"><p class="src"><a id="v:empty" class="def">empty</a> &#8759; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st <a href="src/Ouroboros.Consensus.Ledger.History.html#empty" class="link">Source</a> <a href="#v:empty" class="selflink">#</a></p><div class="doc"><p>Empty (genesis) history</p></div></div><div class="top"><p class="src"><a id="v:snapOld" class="def">snapOld</a> <a href="src/Ouroboros.Consensus.Ledger.History.html#snapOld" class="link">Source</a> <a href="#v:snapOld" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a></td><td class="doc"><p>Maximum rollback (<code>k</code>)</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></td><td class="doc"><p>Slot number of the block that changed the state</p></td></tr><tr><td class="src">&#8594; st</td><td class="doc"><p>State <em>before</em> it changed</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Take a snapshot</p></div></div><div class="top"><p class="src"><a id="v:find" class="def">find</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="Ouroboros-Consensus-Ledger-History.html#t:History" title="Ouroboros.Consensus.Ledger.History">History</a> st &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> st <a href="src/Ouroboros.Consensus.Ledger.History.html#find" class="link">Source</a> <a href="#v:find" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>